# Dise√±o de Controladores PID en Lazo Cerrado
Es un m√©todo de sintonizaci√≥n de controladores PID en el que el sistema opera en lazo cerrado durante la prueba, con el objetivo de identificar par√°metros clave como la ganancia √∫ltima (Ku) y el periodo √∫ltimo (Pu) . Estos valores se utilizan para calcular los par√°metros del controlador (Kp, Ti, Td), logrando as√≠ un equilibrio entre estabilidad y rendimiento del sistema.

## 2. M√©todos de Dise√±o en Lazo Cerrado

La idea central de estos m√©todos es identificar par√°metros caracter√≠sticos de la din√°mica del sistema realizando pruebas en lazo cerrado. A partir de estas pruebas se dise√±a el controlador PID.

## 2.1. M√©todo de Ziegler & Nichols (Ciclo √öltimo)

1. Llevar las ganancias PID a cero (0).
2. Variar (aumentar) la ganancia proporcional (Kp) hasta que la salida del sistema se comporte marginalmente estable.
3. Medir el periodo de la oscilaci√≥n obtenida: **Periodo √∫ltimo (Pu)**.
4. La ganancia a la cual se logr√≥ el estado marginalmente estable se denomina **Ganancia √∫ltima (Ku)**.

üí°**Ejemplo 1:** 

Dada la funci√≥n de transferencia:

$$
G = \frac{1}{s^3 + 6s^2 + 11s + 6}
$$

En lazo cerrado con solo Kp:

$$
G_o = \frac{K_p}{s^3 + 6s^2 + 11s + 6 + K_p}
$$

Se eval√∫a en $$s = j\omega$$ para encontrar los valores cr√≠ticos:

- Frecuencia de oscilaci√≥n:
  
  $$\omega = \sqrt{11}$$

- Periodo √∫ltimo:
  
  $$P_u = \frac{2\pi}{\sqrt{11}} \approx 1.894 \text{ segundos}$$

- Ganancia √∫ltima:
  
  $$K_u = 6\omega^2 - 6 = 6(11) - 6 = 60$$

- Tabla de Ajuste PID (Ziegler & Nichols)

| Tipo | Kp       | Ti         | Td      |
|------|----------|------------|---------|
| P    | 0.5Ku    | ‚Äî          | ‚Äî       |
| PI   | 0.45Ku   | Pu / 1.2   | ‚Äî       |
| PID  | 0.6Ku    | Pu / 2     | Pu / 8  |

Tabla 1. Tabla de ajuste PID


## 2.2. M√©todo del Rel√©

Es una mejora del m√©todo de Ziegler & Nichols que evita llevar el sistema a altos niveles de se√±al de control.

**Metodolog√≠a**

1. Medir el tiempo necesario para obtener estado estacionario en lazo abierto.
2. Cerrar el lazo usando un rel√© con hist√©resis.
3. Capturar la oscilaci√≥n sostenida.
4. Medir el **periodo √∫ltimo (Pu)** y la **amplitud del ciclo √∫ltimo (Au)**.
5. Determinar la **ganancia cr√≠tica (Kc)**.

- Ecuaci√≥n de Ganancia Cr√≠tica

$$K_c = \frac{4d}{\pi \sqrt{A_u^2 - \varepsilon^2}}$$

Donde:
- $$d$$: Amplitud del rel√©.
- $$A_u$$: Amplitud de oscilaci√≥n.
- $$\varepsilon$$: Hist√©resis del rel√©.


- Sintonizaci√≥n de Controladores PI

Usando el m√©todo del rel√©:

$$K_p = \frac{5}{6} K_c$$

$$T_i = \frac{P_u}{5} \left(1 + \frac{4KK_c}{15}\right)$$

Estas f√≥rmulas ofrecen buenos resultados pr√°cticos manteniendo el sobreimpulso por debajo del 10%.

## 2.3. Fen√≥meno Wind-up y Estrategias Anti Wind-up

El fen√≥meno wind-up ocurre cuando el t√©rmino integral contin√∫a acumul√°ndose durante la saturaci√≥n del actuador, causando retrasos o inestabilidad.

**Tipos de estrategias anti wind-up:**

1. **Por saturaci√≥n de la acci√≥n integral**:
   - Limita la acci√≥n integral.
   - Protege al actuador pero afecta el tiempo de respuesta.

2. **Por integraci√≥n condicional**:
   - Suspender la acci√≥n integral bajo saturaci√≥n.
   - Mejora el tiempo de respuesta, pero puede generar pulsos no deseados.

3. **Por rec√°lculo y seguimiento**:
   - Estima el modelo del actuador para suavizar la transici√≥n.
   - Usa la ecuaci√≥n:
     $$T_t = \frac{T_i}{T_d}$$

## 4. Ejercicios de Dise√±o de Controladores PID

üìöEjercicio 1: M√©todo de Ziegler-Nichols (M√©todo del Ciclo √öltimo)

### Fundamento te√≥rico:
Se lleva el sistema a oscilaci√≥n estable para encontrar la **ganancia √∫ltima (Ku)** y el **periodo √∫ltimo (Pu)**, con los que se dise√±an los controladores PID.

### Paso a paso:

#### Planta dada:
$$
G(s) = \frac{1}{s^3 + 6s^2 + 11s + 6}
$$

#### Ecuaci√≥n caracter√≠stica:
$$
s^3 + 6s^2 + 11s + 6 + K_p = 0
$$

Sustituimos $$s = j\omega$$:

- **Parte imaginaria:**
  
  $$-\omega^3 + 11\omega = 0 \Rightarrow \omega = \sqrt{11}$$

- **Parte real:**
  
  $$-6\omega^2 + 6 + K_p = 0 \Rightarrow K_u = 60$$

#### Calcular periodo √∫ltimo:

$$P_u = \frac{2\pi}{\omega} = \frac{2\pi}{\sqrt{11}} \approx 1.894 \text{ segundos}$$

#### Par√°metros del PID:
$$
K_p = 0.6 \cdot K_u = 36
$$
$$
T_i = \frac{P_u}{2} = 0.947
$$
$$
T_d = \frac{P_u}{8} = 0.237
$$

#### Controlador PID dise√±ado:
$$
C(s) = 36 \left(1 + \frac{1}{0.947s} + 0.237s \right)
$$


üìöEjemplo 2: M√©todo del Rel√©

### Fundamento te√≥rico:
Es una mejora del m√©todo de Ziegler-Nichols. Usa un rel√© con hist√©resis para evitar saturaciones extremas y obtener la **ganancia cr√≠tica (Kc)** y el **periodo √∫ltimo (Pu)** sin llevar el sistema a su l√≠mite de estabilidad.

### Paso a paso:

#### Datos medidos:
- Amplitud de salida: $$A_u = 2$$
- Amplitud del rel√©: $$d = 1$$
- Hist√©resis: $$\varepsilon = 0.1$$
- Periodo √∫ltimo: $$P_u = 2.5 \text{ s}$$

#### Ganancia cr√≠tica:
$$
K_c = \frac{4d}{\pi \cdot A_u \cdot \sqrt{1 - \left(\frac{\varepsilon}{A_u}\right)^2}} = \frac{4 \cdot 1}{\pi \cdot 2 \cdot \sqrt{1 - \left(\frac{0.1}{2}\right)^2}} \approx 0.637
$$

#### Dise√±o de controlador PI:
$$
K_p = 0.45 \cdot K_c = 0.287
$$
$$
T_i = \frac{P_u}{1.2} \approx 2.08
$$

#### Controlador PI dise√±ado:
$$
C(s) = 0.287 \left(1 + \frac{1}{2.08s} \right)
$$


## 5. Concluciones 
El documento aborda los m√©todos utilizados para el dise√±o y sintonizaci√≥n de controladores PID en lazo cerrado , centr√°ndose especialmente en dos enfoques cl√°sicos: el m√©todo de Ziegler & Nichols y el m√©todo del rel√© . Estos permiten identificar par√°metros cr√≠ticos del sistema (como la ganancia √∫ltima Ku y el periodo √∫ltimo Pu ) para calcular los valores iniciales de las acciones proporcional (Kp), integral (Ti) y derivativa (Td) del controlador.

Adem√°s, se destacan aspectos pr√°cticos como el fen√≥meno wind-up , que ocurre durante la saturaci√≥n del actuador y puede afectar negativamente la estabilidad del sistema, y las estrategias anti wind-up para mitigarlo, mejorando el desempe√±o real del controlador.


## 6. Referencias

- https://controlautomaticoeducacion.com/control-realimentado/anti-windup-en-un-control-pid/
- http://www.scielo.org.co/scielo.php?script=sci_arttext&pid=S0121-11292019000400119
- https://controlautomaticoeducacion.com/control-realimentado/ziegler-nichols-sintonia-de-control-pid/
- https://www.picuino.com/es/control-ziegler-nichols.html
- [https://www.picuino.com/es/control-ziegler-nichols.html](https://dademuchconnection.wordpress.com/2021/06/24/metodo-ziegler-nichols-ajuste-experimental-de-un-pid/)
